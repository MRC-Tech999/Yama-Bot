var commands = [];

function cmd(info, func) {
  var data = info;
  data.function = func;
  if (!data.dontAddCommandList) data.dontAddCommandList = false;
  if (!info.desc) info.desc = '';
  if (!data.fromMe) data.fromMe = false;
  if (!info.category) data.category = 'misc';
  if (!info.filename) data.filename = "Not Provided";
  commands.push(data);
  return data;
}

function addCommandFromModule(module) {
  if (module.run && typeof module.run === 'object') {
    cmd({
      pattern: module.run.usage[0], // Use the first usage as the pattern
      desc: module.run.desc,
      category: module.run.category,
      filename: module.run.location,
      function: module.run.async,
    });
  }
}

module.exports = {
  cmd,
  AddCommand: cmd,
  Function: cmd,
  Module: cmd,
  commands,
  addCommandFromModule // Added this function
};